import numpy as np
import pandas

def parsefile(filepath):
    f = pandas.read_csv(filepath, comment="#", header=None, engine='c', dtype={0: 'object'})

    md5 = None
    label = None
    data = None

    column_attr = f.ix[0:0,:]
    if 'md5' == column_attr[0][0]: #train dataset with title and label
        f = f.ix[1:,0:] #remove first row
        label = f.ix[0:,1:1]
    md5 = f.ix[0:,:0]
    da = f.ix[0:,2:]
    data = np.array(da,dtype="float32")
    return data, label, md5

if __name__=='__main__':
    data, label, md5 = parsefile('dataset/train_info.csv')
    print data, label, md5
    data, label, md5 = parsefile('dataset/test_info.csv')
    print data, label, md5
